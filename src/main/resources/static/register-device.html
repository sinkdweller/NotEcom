<html>
    <head>
        <link rel="stylesheet" href="/style.css">
        <script src="/navloader.js" defer></script>
    </head>
    <body>
        <div class="vertical-contain">
                <label for="deviceName">device name</label>
                <input id="deviceName" name="deviceName">

                <label for="macAddress">Mac address</label>
                <input id="macAddress" name="macAddress">

                <label for="generatedCode"> Device claim code</label>
                <input id="generatedCode" name="generatedCode">
                <button class="space-around" onclick="submitDeviceClaim(document.getElementById('deviceName').value, document.getElementById('macAddress').value, document.getElementById('generatedCode').value)">claim</button>

        </div>
        
    </body>
    <script>
        token = localStorage.getItem("token");
        async function submitDeviceClaim(deviceName, macAddress, generatedCode){
            console.log("Payload being sent:", {
            macAddress: macAddress,
            generatedCode: generatedCode,
            name: deviceName
        });
            const response = await fetch("/api/claim", {
                method: "POST",
                headers: {
                    "Content-type": "Application/json",
                    "Authorization": `Bearer ${token}`
                },
                body: JSON.stringify({
                    macAddress: macAddress,
                    generatedCode: generatedCode,
                    name: deviceName
                })
            })
            if(response.ok){
                alert("device registered!")
            }else{
                const error = await response.text();
                alert(error)
            }
        }
    </script>


</html>



